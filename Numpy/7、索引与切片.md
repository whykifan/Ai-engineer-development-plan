
<!-- TOC -->

- [Numpy中的索引与切片](#numpy中的索引与切片)
    - [1、单个元素的索引](#1单个元素的索引)
    - [2 、切片支持](#2-切片支持)
    - [3、花式索引](#3花式索引)
    - [4、布尔索引数组](#4布尔索引数组)
    - [5、结构化索引工具](#5结构化索引工具)
    - [6、给被索引的数组赋值](#6给被索引的数组赋值)

<!-- /TOC -->

# Numpy中的索引与切片
Python 中原生的数组就支持使用方括号 **（[]）** 进行索引和切片操作，Numpy 自然不会放过这个强大的特性。

## 1、单个元素的索引
1-D数组的单元素索引是人们期望的。它的工作原理与其他标准Python序列一样。**它是从0开始的**，**并且接受负索引来从数组的结尾进行索引**。
```python
>>> x = np.arange(10)  
>>> x[2]  
2  
>>> x[-2]  
8
```
与Python原生的列表、元组不同的是**，Numpy数组支持多维数组的多维索引:**
```python
>>> x.resize(2,5)  
>>> x  
array([[0, 1, 2, 3, 4],  
	   [5, 6, 7, 8, 9]])  
>>> x[1,3]  
8  
>>> x[1,-1]  
9  
>>> x[1][-1]  
9
```
**x[1,-1] 的结果等于 x[1][-1]，但是第二种情况效率更低，因为第二种方式创建了一个临时数组。**
## 2 、切片支持

可以使用切片和步长来截取不同长度的数组，使用方式与Python原生的对列表和元组的方式相同。
```python
>>> x[2:5]  
array([2, 3, 4])  
>>> x[:-7]  
array([0, 1, 2])  
>>> x[1:7:2]  
array([1, 3, 5])  
>>> y = np.arange(35).reshape(5,7)  
>>> y[1:5:2,::3]  
array([[ 7, 10, 13],  
[21, 24, 27]])
```
**注意**：**使用切片不会复制内部数组数据，但也会生成原始数据的新视图。**

## 3、花式索引
**花式索引指的是利用整数数组进行索引。**

花式索引根据索引数组的值作为目标数组的某个轴的下标来取值。对于使用一维整型数组作为索引，如果目标是一维数组，那么索引的结果就是对应位置的元素；如果目标是二维数组，那么就是对应下标的行。

Numpy数组可以被其他数组索引。对于索引数组的所有情况，**返回的是原始数据的副本，而不是一个获取切片的视图**（也即:**花式索引跟切片不一样，它总是将数据复制到新数组中**。）。

**索引数组必须是整数类型。**
```python
>>> x = np.arange(10,1,-1)  
>>> x  
array([10, 9, 8, 7, 6, 5, 4, 3, 2])  
>>> x[np.array([3, 3, 1, 8])]  
array([7, 7, 9, 2])
>>>x=np.arange(32).reshape((8,4))  
>>>x[[4,2,1,7]])
[[16  17  18  19] 
 [24  25  26  27] 
 [28  29  30  31] 
 [  4  5  6  7]]
```
## 4、布尔索引数组
**布尔索引通过布尔运算（如：比较运算符）来获取符合指定条件的元素的数组**。

使用（整数）索引列表时，需要提供要选择的索引列表，**最后生成的结果形状与索引数组形状相同**；**但是在使用布尔索引时，布尔数组必须与要编制索引的数组的初始维度具有相同的形状**。在最直接的情况下，布尔数组具有相同的形状：
```python
>>> y  
array([[ 0, 1, 2, 3, 4, 5, 6],  
[ 7, 8, 9, 10, 11, 12, 13],  
[14, 15, 16, 17, 18, 19, 20],  
[21, 22, 23, 24, 25, 26, 27],  
[28, 29, 30, 31, 32, 33, 34]])  
>>> b = y > 20  
>>> y[b]  
array([21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34])
```
与整数索引数组的情况不同，在布尔数组中，**结果是1-D数组，其包含索引数组中的所有元素**，对应于布尔数组中的所有真实元素。索引数组中的元素始终以**行优先（C样式）顺序进行迭代和返回**。结果也与`y[np.nonzero(b)]`相同。与索引数组一样，返回的是数据的副本，而不是一个获取切片的视图。
如果y比b的维数更高，则结果将是多维的。例如：
```python
>>> y[[False, False, False, True, True]]  
array([[21, 22, 23, 24, 25, 26, 27],  
	   [28, 29, 30, 31, 32, 33, 34]])
```
## 5、结构化索引工具
为了便于数组形状与表达式和赋值关系的匹配，**可以在数组索引中使用np.newaxis对象来添加大小为1的新维**。例如:
```python
>>> y.shape  
(5L, 7L)  
>>> y[:,np.newaxis,:].shape  
(5L, 1L, 7L)
```
注意，在数组中没有新的元素，只是维度增加。这可以方便地以一种方式组合两个数组，否则将需要明确重塑操作。例如：
```python
>>> x = np.arange(5)  
>>> x  
array([0, 1, 2, 3, 4])  
>>>x[:,np.newaxis]
[[0]
 [1]
 [2]
 [3]
 [4]]
>>>x[np.newaxis,:]
[[0 1 2 3 4]]
>>> x[:,np.newaxis] + x[np.newaxis,:]
array([[0, 1, 2, 3, 4],  
	   [1, 2, 3, 4, 5],  
       [2, 3, 4, 5, 6],  
       [3, 4, 5, 6, 7],  
       [4, 5, 6, 7, 8]])
```
省略语法（三个点）可以用于指示完全选择任何剩余的未指定维度。如果数组z的形状是(3,3,3,3)，那么z[1,...,2]等效于z[1,:,:,2]。例如：
```python
>>> z = np.arange(81).reshape(3,3,3,3)  
>>> z[1,...,2]  
array([[29, 32, 35],  
[38, 41, 44],  
[47, 50, 53]])  
>>> z[1,:,:,2]  
array([[29, 32, 35],  
[38, 41, 44],  
[47, 50, 53]])
```
## 6、给被索引的数组赋值
可以使用单个索引，切片，索引和布尔数组来选择数组的子集来分配。分配给索引数组的值必须是形状一致的（相同的形状或可广播到索引产生的形状）。例如，允许为切片分配常量：
```python
>>> x = np.arange(10)  
>>> x[2:7] = 1
#或正确大小的数组：
>>> x[2:7] = np.arange(5)
```
